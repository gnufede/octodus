{% from "macros/_misc.html" import render_input, render_action %}

{% set page_title = 'Pasos para hacerte la orla' %}

{% extends "layout.html" %}

{% block body %}
<div class="span9">	
{{ proceso|safe }}
</div>	
{% if form %}
{% set page_title = 'Registrate para hacerte la orla' %}
<div class='span3'>
    <form class='form-stacked' method="POST" action="{{ url_for('frontend.signup') }}">
        {{ form.hidden_tag() }}
        {{ form.next }}
        <fieldset>
            <legend>Ya tienes cuenta? <a href="{{ url_for('frontend.login') }}">Entra</a> por favor.</legend>
            {{ render_input(form.code, 'xlarge') }}
            {{ render_input(form.name, 'xlarge') }}
            {{ render_input(form.surname, 'xlarge') }}
            {{ render_input(form.email, 'xlarge') }}
            {{ render_input(form.password, 'xlarge') }}
            {{ render_input(form.password_again, 'xlarge') }}
            {{ render_input(form.nocode, 'xlarge', labelAfter=True) }}
            {{ render_action(form.submit) }}
        </fieldset>
    </form>
</div>
{% endif %}
{% endblock %}

{% block append_js %}
<script>
    $('#orlas').addClass('active');
    $('label[for="nocode"]').css('display','inline-block');
    $('.actions').css('margin-top','12px');
</script>
<script  src="{{ url_for('static', filename='js/libs/mailcheck.min.js') }}"></script>

<script>
function changeEmail(suggestion){
        $('#email').val(suggestion);
  $('#email').next().text('');// callback code
}
/*var domains = ['hotmail.com', 'gmail.com', 'aol.com'];
var topLevelDomains = ["com", "net", "org"];

var superStringDistance = function(string1, string2) {
  // a string distance algorithm of your choosing
}
*/
$('#email').on('blur', function() {
  $('#email').next().text('');// callback code
  $(this).mailcheck({
    suggested: function(element, suggestion) {
       if (suggestion){
        var ayudita = $('#email').next();
        $('<p>Quiso decir <a href="javascript:void(0)" onclick="changeEmail(\''+suggestion.full+'\');">'+suggestion.full+'</a>?</p>').appendTo(ayudita)
        }
    },
    empty: function(element) {
      // callback code
    }
  });
});

</script>
{% endblock %}
